import{s as c,i as B}from"./nBtS1XGq.js";import{f as C}from"./D2nGpDRe.js";import{b as x}from"./BxPoHLz2.js";import{g as q,i as g,s as A,v as j,c as L,a as n,t as O,o as R}from"./BYXYRwLn.js";function y(u){return Math.sqrt(1- --u*u)}const S={class:"line"},T={class:"left"},D=n("div",{class:"right"},[n("strong",null,"# commit")],-1),E=n("div",{class:"tooltip-inner"},"Test",-1),F=n("div",{class:"tooltip-arrow"},null,-1),N=[E,F],I=q({__name:"BarChart",props:{timeLabel:{type:String,default:""},data:{type:Array},formatter:{type:Function,default:C(",d")}},setup(u){const l=u,_=g(null),h=g(null),m=g(null),w=async()=>{m.value.formatter=l.formatter;const i=[];for(const t of l.data){let e=0;for(const o of t.values)e+=o.value;i.push(e)}let d=0;for(const t of i)d=Math.max(d,t);let p=d;for(const t of l.data)for(const e of t.values)e.value>0&&(p=Math.min(p,e.value));p=Math.max(p,1e-6);const b=t=>{t.transition().duration(e=>450).ease(x).style("width",(e,o)=>70*i[o]/d+"%")},M=t=>{t.transition().duration(450).ease(y).style("flex-grow",e=>e.value===0?0:Math.max(1,e.value/p)).style("background-color",e=>e.color)},k=async t=>{t.transition().duration(e=>350).textTween(function(e,o){const a=i[o],r=this._current;this._current=a;const s=m.value.formatter;if(r===void 0)return v=>s(a);if(r<=1&&a>=1)return v=>s(a);if(r>=1&&a<=1)return v=>s(a);const f=B(r,i[o]);return v=>s(f(v))})};c(h.value).selectAll(".line").data(l.data,t=>t.label).join(t=>{const e=t.append("div");e.classed("line",!0),e.style("filter","blur(4px)").style("height","0px").style("opacity",.3).style("transform","translate(-32px, 0)").transition().duration((s,f)=>450+30*Math.sqrt(f)).ease(x).style("height","24px").style("transform","translate(0px, 0)").style("filter","blur(0px)").transition().duration(s=>450).ease(x).style("filter","none").style("opacity",1).style("filter","none");const o=e.append("div");o.classed("left",!0),o.text(s=>s.label);const a=e.append("div");a.classed("center",!0),b(a);const r=e.append("div");return r.classed("right",!0),r.text(0),r.property("_current",s=>0),k(r),e},t=>{const e=t.select(".center");b(e);const o=t.select(".right");return k(o),t},t=>{t.transition().duration((e,o)=>350).delay((e,o)=>500-30*Math.sqrt(o)).ease(y).style("opacity","0.2").style("filter","blur(3px)").transition().duration((e,o)=>150).ease(y).style("transform","translate(64px, 0)").style("height","0px").style("opacity","0").remove()}).select(".center").selectAll(".repository").data(t=>t.values,t=>t.label).join(t=>{const e=t.append("div");return e.classed("repository",!0).style("flex-grow",0),M(e),e.on("mouseover",function(o,a){const r=c(this).node().getBoundingClientRect(),s=c(_.value).select(".tooltip-inner");c(_.value).transition().duration(200).ease(y).style("opacity",1).style("left",r.left+r.width/2+"px").style("top",r.top+"px");const f=m.value.formatter;s.text(a.label+": "+f(a.value))}),e},t=>(M(t),t),t=>t.transition().duration(450).ease(y).style("flex-grow",0).remove())};return A(()=>l.data,w),j(()=>{c(h.value).on("mouseout",()=>{c(_.value).transition().duration(600).delay(1e3).style("opacity",0)}),m.value={formatter:l.formatter},w()}),(i,d)=>(R(),L("div",null,[n("div",S,[n("div",T,[n("strong",null,O(u.timeLabel),1)]),D]),n("div",{ref_key:"histogram",ref:h,class:"histogram"},null,512),n("div",{ref_key:"tooltip",ref:_,class:"tooltip"},N,512)]))}});export{I as _};
